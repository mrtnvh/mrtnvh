---
import { getSrcSet } from './cloudinary';

export interface ImageTint {
  shadows: string;
  highlights: string;
}

export interface Props {
  src: string;
  alt: string;
  width: string;
  height: string;
  class: string;
  loading?: boolean;
  tint: ImageTint | string;
}

const { alt, src: source, width, height, tint, loading = false } = Astro.props as Props;
const { src, srcSet } = getSrcSet({ src: source, tint });
const { srcSet: srcSetWebp } = getSrcSet({ src: source, type: 'webp', tint });
// const { srcSet: srcSetDark } = getSrcSet({ src: source, tint, dark: true });
// const { srcSet: srcSetDarkWebp } = getSrcSet({
//   src: source,
//   type: 'webp',
//   tint,
//   dark: true,
// });
---

<picture>
  <!-- <source sizes="1px" srcset={srcSetDark} media="(prefers-color-scheme: dark)" />
  <source sizes="1px" srcset={srcSetDarkWebp} type="image/webp" media="(prefers-color-scheme: dark)" /> -->
  <source sizes="1px" srcset={srcSetWebp} type="image/webp" />
  <img
    {src}
    srcset={srcSet}
    sizes="1px"
    {alt}
    class="image fade fade-inactive"
    {loading}
    {width}
    {height}
    style={`aspect-ratio: ${width} / ${height}`}
  />
</picture>

<style>
  picture {
    display: flex;
    background-color: var(--grey-200);
  }

  img {
    width: 100%;
    height: auto;
    object-fit: cover;
  }
</style>
